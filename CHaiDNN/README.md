# CHaiDNN 

The CNN accelerator used to analyze the memory trace here is the [Xilinx CHaiDNN](https://github.com/Xilinx/CHaiDNN). There are some modifications to the original design to make the accelerator compatible with Vivado HLS. A wrapper is added to the design of the accelerator to ensure that there is only one top-level hardware function. In addition, the memory interface for the top level ports are changed from m_axi interface to a bus interface.

## How to Run

The Vivado HLS C/RTL co-simulation can be run using the tcl script run.tcl. The top-level file should specify the network for the simulation and be placed in software/examples. To specify the network, the prototxt and caffemodel are needed. Because most models are not compatible with the CHaiDNN, the caffemodel and prototxt for different models should be downloaded from the [Xilinx CHaiDNN Model Zoo](https://github.com/Xilinx/CHaiDNN/blob/master/docs/MODELZOO.md). The top-level file should be similar to the examples already provided.

Once the simulation is completed, the waveform for the top-level signals should be saved to a vcdfile. 

## How to Extract The Memory Trace

Once the vcdfile with signal of the memory trace is collected, the vcdfile can be parsed adn the graphs of the memory accesses can be generated by running the following command, where file is the name of the vcdfile and dir is the name of the output directory in which the graphs will be placed:

```shell
python parse.py [file] [dir]
```

The plot of all of the memory accesses is saved at dir/memoryaccesses.png. 
